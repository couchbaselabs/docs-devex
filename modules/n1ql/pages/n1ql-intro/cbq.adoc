= cbq: The Command Line Shell for {sqlpp}
:description: cbq is a comprehensive command line shell for {sqlpp}.
:tabs:
:page-partial:

[abstract]
{description}
It is a powerful, developer friendly tool that enables you to query and update data from Couchbase Capella.
The cbq shell enables you to perform all the operations that are supported by the Query tab and more, such as additional scripting functionality.

include::ROOT:partial$component-signpost.adoc[]

The cbq shell executable, [.cmd]`cbq`, is available in the Couchbase xref:reference:command-line-tools.adoc[command line tools] package beginning with version 7.6.2.

== Prerequisites

The procedures on this page assume the following:

* You have xref:clusters:manage-database-users.adoc[configured database access] by creating database access credentials.
You'll need the username and password for the database credentials to connect to the database.
* You have xref:clusters:allow-ip-address.adoc[added your IP address] to the database's list of allowed IPs.
* You have xref:get-started:create-account.adoc#next-steps[downloaded your security certificate] for your database.
* You have xref:reference:command-line-tools.adoc[downloaded and installed] the command line tools package.

You can do all of this from a single location using the Connect page in the Capella UI.
See xref:get-started:connect.adoc[] and follow the instructions for the CLI tools.

== Examples on this Page

The examples on this page use the `travel-sample` dataset, which is supplied with Couchbase Capella.
For instructions on how to install the sample data, see xref:clusters:data-service/import-data-documents.adoc#import-sample-data[Import Sample Data].

[tabs]
====
Linux / macOS::
+
--
In the command line examples:

* `$BASE_URL` is the connection string generated by Couchbase Capella.
* `$USER` is the user name for the database credentials.
* `$PASSWORD` is the password for the database credentials.
* `$CACERT` is the name and path of the database security certificate.
--

Microsoft Windows::
+
--
In the command line examples:

* `%BASE_URL%` is the connection string generated by Couchbase Capella.
* `%USER%` is the user name for the database credentials.
* `%PASSWORD%` is the password for the database credentials.
* `%CACERT%` is the name and path of the database security certificate.
--

Shell Command::
+
--
In the shell command examples:

* `<BASE_URL>` is the connection string generated by Couchbase Capella.
* `<USER>` is the user name for the database credentials.
* `<PASSWORD>` is the password for the database credentials.
* `<CACERT>` is the name and path of the database security certificate.
--
====

== Running the cbq Shell

When starting the cbq shell you can provide a set of command line options.
If no options are present then it assumes default values for expected options.

To run [.cmd]`cbq`:

. Open a command window.
. Change to the directory where you installed the Couchbase command line tools.
+
[tabs]
====
Linux::
+
--
[source,sh]
----
cd couchbase-server-tools/bin
----
--

macOS::
+
--
[source,sh]
----
cd couchbase-server-tools/bin
----
--

Microsoft Windows::
+
--
[source,cmd]
----
cd couchbase-server-tools\bin
----
--
====

. Run the following command to connect to the Couchbase Capella database and start the interactive query shell:
+
[tabs]
====
Linux::
+
--
[source,sh]
----
./cbq -u $USER -p $PASSWORD -e $BASE_URL --cacert $CACERT -skip-verify
----
--

macOS::
+
--
[source,sh]
----
./cbq -u $USER -p $PASSWORD -e $BASE_URL --cacert $CACERT -skip-verify
----
--

Microsoft Windows::
+
--
[source,cmd]
----
cbq -u %USER% -p %PASSWORD% -e %BASE_URL% --cacert %CACERT% -skip-verify
----
--
====

For more information about connecting to Couchbase Capella, see <<cbq-connect-to-cluster>>, <<cbq-single-cred>>, and <<cbq-encrypted>>.

For the complete list of command line options, see <<table_a3h_rhz_dw>>.


=== Executing a Single Command

The cbq shell prompt `cbq>` accepts shell commands as well as {sqlpp} commands.
All the cbq shell commands start with a backslash (`\`).
If the command does not start with a backslash (`\`), the cbq shell interprets the command as a {sqlpp} command.

* To execute a {sqlpp} query at the cbq prompt, type the query.
At the end of the query, type a semicolon `;` and press kbd:[Enter].

* To execute a cbq command at the cbq prompt, type the command name starting with a backslash `\`.
At the end of the command, type a semicolon `;` and press kbd:[Enter].

The cbq shell enables you to manipulate query parameters.
See <<cbq-parameter-manipulation>> for details.

For the complete list of shell commands, see <<table_htk_hgc_fw>>.

=== Support for Multi-line Queries

The cbq shell supports multi-line queries by default, enabling you to enter a query over multiple lines.
When entering a query, you can hit kbd:[Enter] without specifying a semicolon (`;`) at the end of the line to move the cursor to the next line.
The prompt `>` indicates that the shell is in multi-line mode.
For example:

====
[source,console]
----
cbq> SELECT *
   > FROM `travel-sample`.inventory.airline
   > LIMIT 1;
----
====

When you're done, use a semicolon `;` to indicate the end of the query, and then press kbd:[Enter] to execute the query.

=== Handling Comments

You can add comments in your query by preceding the comment with a `&num;` or `--`.
The cbq shell interprets a line that starts with `&num;` or `--` as a comment, logs the line into history, and returns a new prompt.
No other action is taken.

====
[source,sqlpp]
----
SELECT *
#This is the first comment
FROM `travel-sample`.inventory.airline
--This is the second comment
LIMIT 1;
----
====

However, if a comment exists within a statement, it is considered as part of the {sqlpp} command.
If the cbq shell encounters a block comment (enclosed between `/{asterisk}` \... `{asterisk}/`) within a statement, it sends the block comment to the query service.

====
[source,sqlpp]
----
SELECT * FROM `travel-sample`.inventory.airline /* Block comment */ LIMIT 1;
----
====

=== File Based Operations

The cbq shell can execute {sqlpp} and shell commands contained in files using file-based commands and options.
See <<cbq-file-based-ops>> for more information.

=== History

The [.cmd]`cbq` shell stores the history for every session.
All the commands executed in a session are stored in history.
By default, history is stored in `~/.cbq_history`.
You can change the name of the file using the SET command to set the predefined parameter [.var]`HISTFILE`.
See <<cbq-parameter-manipulation>> for more information.

By default, all the commands are stored in the specified file.
You can scroll through history and retrieve the commands from history using the scrolling arrow keys.
Once the query is on the command prompt, you can edit it before executing the updated query.

=== Help

Help displays the help information for the shell commands and for the general usage of cbq.

[tabs]
====
Command Line Option::
+
--
Use the `-h` or `--help` command line option when bringing up the shell to display the information for all available options.

'''

.Example
[source,sh]
----
./cbq -h
----
--

Shell Command::
+
--
Use the [.cmd]`\HELP` shell command during a session to display information for specific shell commands.
If you specify one or more commands, the shell displays the usage information for the specified commands.

If you do not specify a command, the cbq shell lists all the commands for which syntax help is available.

'''

.Example
[source,sqlpp]
----
\HELP;
----
--
====

[#cbq-connect-to-cluster]
== Connecting to the Database

To connect the cbq shell to the database, use the connection string generated by Couchbase Capella.

[tabs]
====
Command Line Option::
+
--
To establish a connection on startup, use the `-e` or `--engine` command line option, followed by the connection string.

'''

.Example
[source,sh]
----
./cbq -e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

.Result
----
Connected to : https://<HOST>:18091/. Type Ctrl-D or \QUIT to exit.

Path to history file for the shell : ~/.cbq_history
----
--

Shell Command::
+
--
To establish a connection during a session, use the `\CONNECT` shell command, followed by the connection string.

'''

.Example
[source,sqlpp]
----
\CONNECT <BASE_URL>;
----

.Result
----
Connected to : https://<HOST>:18091/. Type Ctrl-D or \QUIT to exit.
----
--
====

By default, the connection string is a URL, consisting of the protocol scheme and the host.

To connect to Couchbase Capella, you must use the `couchbases://` protocol scheme.
This protocol scheme is encrypted.
For more details, refer to <<cbq-encrypted>>.

Note that you cannot specify the port when using the `couchbases://` protocol scheme.

If you do not specify the connection string, the default URL `+http://localhost:8091+` is used.
This does not enable you to connect to Couchbase Capella.
An error is thrown if the URL is invalid.

=== Disconnecting

You can close the connection with a Couchbase Capella database during the session without exiting the shell using the [.cmd]`\DISCONNECT;` command.
If the shell is not connected to a database, an error with a message that the shell is not connected to any instance is thrown.

====
.Example
[source,sqlpp]
----
\DISCONNECT;
----

.Result
----
Couchbase query shell not connected to any endpoint. Use \CONNECT command to connect.
----
====

=== Bringing Up an Unconnected Instance

You can bring up the shell without connecting to a Couchbase Capella database by using the [.opt]`-ne` or [.opt]`--no-engine` option.
After starting cbq without any connection, you can connect to a database using the [.cmd]`CONNECT` command.

====
.Example
[source,sh]
----
./cbq -ne
----

.Result
----
Path to history file for the shell : ~/.cbq_history
----
====

=== Exiting the cbq Shell

You can exit the cbq shell by pressing kbd:[Ctrl+D] or by using the `\EXIT` or `\QUIT` command.

The cbq shell first saves the history, closes existing connections, saves the current session in a session file, resets all environment variables, and then closes the shell liner interface.

====
.Example
[source,sqlpp]
----
\EXIT;
----

.Result
[source,console]
----
$
----
====

[#cbq-single-cred]
== Providing Credentials

You can pass a single user name credential to the cbq shell on startup using the `-u` or `--username` command line option, followed by the user name.
The shell then prompts you for a password.

====
.Example
[source,sh]
----
./cbq -e $BASE_URL -u $USER -skip-verify
----

.Result
----
Enter Password:
Connected to : https://<HOST>:18091/. Type Ctrl-D or \QUIT to exit.
----
====

You can also provide a single password credential using the `-p` or `--password` command line option, followed by the password.
You cannot use this option by itself.
It must be used with the `-u` option to specify the user name that the password is associated with.

====
.Example
[source,sh]
----
./cbq -e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

.Result
----
Connected to : https://<HOST>:18091/. Type Ctrl-D or \QUIT to exit.
----
====

[#accessing-a-secure-keyspace]
=== Providing Credentials in the Connection String

You can pass the username and password by inserting them into the connection string.
This method is not recommended when starting cbq, as you must quote or URL-encode any special characters in the username or password.
However, this method may be useful for specifying the username and password when connecting to Couchbase Capella within a cbq session.

To pass credentials in the connection string:

. Add the username immediately after the `couchbases://` protocol scheme.
. After the username, add a colon `:` followed by the password.
. After the password, add an at sign `@` followed by the rest of the connection string.

[tabs]
====
Command Line Option::
+
--
To pass credentials on startup, use the `-e` or `--engine` command line option, and specify the username and password in the connection string.

'''

In this example, `$HOST` is the part of the connection string following the `couchbases://` protocol scheme.

.Example
[source,sh]
----
./cbq -engine="couchbases://$USER:$PASSWORD@$HOST/" -skip-verify
----
--

Shell Command::
+
--
To pass credentials during a session. use the `\CONNECT` shell command, and specify the username and password in the connection string.

'''

In this example, `<HOST>` is the part of the connection string following the `couchbases://` protocol scheme.

.Example
[source,sqlpp]
----
\CONNECT couchbases://<USER>:<PASSWORD>@<HOST>;
----
--
====

[#cbq-multiple-creds]
=== Switching Between Credentials

When starting the cbq shell, you can set the credentials using a single command line option, as an alternative to specifying the username and password separately.
This method is not recommended, as you must quote or escape any special characters in the username or password.

You can also use the `\SET` or `\PUSH` shell command to set the credentials query parameter within a session.
This enables you to change credentials before executing a query, for example to switch to a database user with access to another keyspace.
Note that the credentials are set for the remainder of the shell session and not just on a per query basis.

The list of credentials can contain one or multiple credentials.
Each credential consists of an identity and a password separated by a colon `:`.
However, if you specify multiple credentials, Couchbase Capella only recognizes the first credential.

[tabs#pass-cred-shell-cmd]
====
Command Line Option::
+
--
To set the credentials on startup, use the `-c` or `--credentials` command line option, followed by the list of credentials.

'''

.Example
[source,sh]
----
./cbq -e $BASE_URL -c=$USER:$PASSWORD -skip-verify
----
--

Shell Command::
+
--
To change credentials during a session, use the `\SET` shell command to specify the [.param]`-creds` query parameter, followed by the list of credentials.

'''

.Example
[source,sqlpp]
----
\SET -creds <USER>:<PASSWORD>;
----
--
====

ifdef::flag-devex-rest-api[]
For more information about the `creds` parameter, see xref:n1ql:n1ql-rest-api/intro.adoc#creds[Query Service REST API] and xref:n1ql:n1ql-rest-api/exauthrequest.adoc[].
endif::flag-devex-rest-api[]

=== Displaying the Credentials

You can display the credentials for the current session using the <<cbq-echo,ECHO>> shell command.
This command displays only the user names (and not the passwords).

====
.Example
[source,sqlpp]
----
\ECHO -creds;
----

.Result
----
<USER>:*
----
====

You can also display a full list of variables using the <<cbq-set,SET>> command specified without any arguments.

====
.Example
[source,sqlpp]
----
\SET;
----

.Result
----
Query Parameters ::
Parameter name : timeout Value  ["3ms" "4s"]

Named Parameters ::
Parameter name : r Value  [9.5 9.5]

User Defined Session Parameters ::

Predefined Session Parameters ::
Parameter name : histfile Value  [".cbq_history"]
----
====

[#cbq-encrypted]
== Using an Encrypted Connection

You must use the encrypted `couchbases://` protocol scheme with a domain name to connect to a database deployed in Couchbase Capella.
To do this, you can provide the root CA certificate, the chain certificate, and the client key file using the <<opt-cacert,--cacert>>, <<opt-cert,--cert>>, and <<opt-key,--key>> options.
You can use the <<opt-skip-verify,--no-ssl-verify>> option to skip the verification of certificates.

For more details, refer to <<cbq-connect-to-cluster>>.

[#cbq-parameter-manipulation]
== Parameter Manipulation

The cbq shell categorizes parameters into the following types:

* Query parameters
* Named parameters
* User-defined session variables
* Pre-defined session variables

=== Parameter Configuration

When using parameters, you can set a stack of values for each parameter.
You can either push a new value onto the stack using the `\PUSH` command, or set the current value for a parameter using the `\SET` command.
The `\SET` command always modifies the top of a variable's stack while the `\PUSH` command adds to the stack.
When you use `\PUSH` with no arguments, it copies the top element of every parameter's stack (except the predefined parameters) and pushes that copy to the top of its respective stack.
As a result, each stack grows by 1, but the values are preserved.
You can then use the `\SET` command to modify the top value.

To unset the values from a parameter's stack, you can use the `\UNSET` command to remove all the values from the stack and delete the corresponding parameter stack.
However, if you want to delete a single value from the settings, use the `\POP` command.
When you use the `\POP` command with no arguments, it pops the one value from the top of each parameter's stack.

To display all the parameters defined in a session, use the `\SET` command with no arguments.

=== Setting Variable Values

To set the value of a parameter, use the `\SET` or `\PUSH` shell command, followed by a parameter name and parameter value.

The parameter name may have a prefix, depending on the type of parameter: query parameter, named parameter, user-defined session variable, or predefined session variable.
The cbq shell uses the prefix to differentiate between the different types of parameters.

.Prefixes for Parameters
[#table_ltk_c5s_5v,cols="2,5"]
|===
| Prefix | Parameter Type

| `-`
| Query parameter

| `-$` or `-@`
| Named parameters

| `$`
| User defined session variable

| No prefix
| Predefined (built-in) session variable
|===

NOTE: Positional parameters are set using the [.param]`-args` query parameter.

For more details about the available query parameters (prefixed by `-`), see xref:n1ql:n1ql-manage/query-settings.adoc#section_nnj_sjk_k1b[Request-Level Parameters].
As a best practice, save the initial set of basic parameters and their default values using the [.cmd]`\PUSH` command (with no arguments).

====
The following example sets the `airport` named parameter, pushes two positional parameters to the `args` query parameter stack, and then displays all parameters.

.Example
[source,sqlpp]
----
\SET -$airport "SJC";
\PUSH -args ["LAX", 6];
\SET;
----

.Result
----
Query Parameters ::
Parameter name : args Value  [["LAX",6]]

Named Parameters ::
Parameter name : airport Value  ["SJC"]

User Defined Session Parameters ::

Predefined Session Parameters ::
Parameter name : histfile Value  [".cbq_history"]
----

The following example pushes a new value to the `airport` named parameter stack, duplicates the top value in each stack except the predefined session parameters, and then displays all parameters.

.Example
[source,sqlpp]
----
\PUSH -$airport "SFO";
\PUSH;
\SET;
----

.Result
----
Query Parameters ::
Parameter name : args Value  [["LAX",6] ["LAX",6]]

Named Parameters ::
Parameter name : airport Value  ["SJC" "SFO" "SFO"]

User Defined Session Parameters ::

Predefined Session Parameters ::
Parameter name : histfile Value  [".cbq_history"]
----

The following example sets the top level of the `airport` named parameter stack to a new value, and then displays all parameters.

.Example
[source,sqlpp]
----
\SET -args ["SFO", 8];
\SET;
----

.Result
----
Query Parameters ::
Parameter name : args Value  [["LAX",6] ["SFO",8]]

Named Parameters ::
Parameter name : airport Value  ["SJC" "SFO" "SFO"]

User Defined Session Parameters ::

Predefined Session Parameters ::
Parameter name : histfile Value  [".cbq_history"]
----
====

=== Handling Named Parameters

To define named parameters, use the `\SET` or `\PUSH` command.
For each named parameter, prefix the variable name with `-$` or `-@`.

For more details about named parameters, see xref:n1ql:n1ql-manage/query-settings.adoc#section_srh_tlm_n1b[Named Parameters and Positional Parameters].

====
The following example creates named parameters `r` and `date` with values `9.5` and `"1-1-2016"` respectively.

.Example
[source,sqlpp]
----
\SET -$r 9.5;
\SET -@date "1-1-2016";
----
====

=== Handling Positional Parameters

To define positional parameters, use the `\SET` or `\PUSH` command with the [.param]`-args` query parameter, followed by an array containing the different values that correspond to positions within the query.

For more details about positional parameters, see xref:n1ql:n1ql-manage/query-settings.adoc#section_srh_tlm_n1b[Named Parameters and Positional Parameters].

====
.Example
[source,sqlpp]
----
\SET -args [ 9.5, "1-1-2016"];
----
====

=== Handling Predefined Session Variables

The following table lists the available predefined session variables.

.Predefined Session Variables
[cols="1,1,2"]
|===
| Variable Name | Possible Values | Description

| HISTFILE
| Valid file name
| Specifies the file name to store the command history.
By default the file is saved in the user's home directory.

Default: `.cbq_history`
|===

=== Resetting Variable Values

You can reset the value of a variable by either popping it or deleting it altogether.

To pop the top of every parameter's stack once, use the `\POP` command without any arguments.

====
.Example
[source,sqlpp]
----
\POP;
\SET;
----

.Result
----
Query Parameters ::
Parameter name : args Value  [["LAX",6]]

Named Parameters ::
Parameter name : airport Value  ["SJC" "SFO"]

User Defined Session Parameters ::

Predefined Session Parameters ::
Parameter name : histfile Value  [".cbq_history"]
----
====

To pop the top value from a single parameter's stack, use the `\POP` command, followed by the parameter prefix and parameter name.

====
.Example
[source,sqlpp]
----
\POP -$airport;
\SET;
----

.Result
----
Query Parameters ::
Parameter name : args Value  [["LAX",6]]

Named Parameters ::
Parameter name : airport Value  ["SJC"]

User Defined Session Parameters ::

Predefined Session Parameters ::
Parameter name : histfile Value  [".cbq_history"]
----
====

To pop all the values of a parameter's stack and then delete the parameter, use the `\UNSET` command, followed by the parameter prefix and parameter name.

====
.Example
[source,sqlpp]
----
\UNSET -$airport;
\SET;
----

.Result
----
Query Parameters ::
Parameter name : args Value  [["LAX",6]]

Named Parameters ::

User Defined Session Parameters ::

Predefined Session Parameters ::
Parameter name : histfile Value  [".cbq_history"]
----
====

[#cbq-shell-cmd-echo]
== Using ECHO to Display Values of Parameters and More

The ECHO command displays the current values of the parameters set for a session.
You can use it to display any input string or command aliases that have been created using the ALIAS shell command.

=== Echo a String or Statement

To echo a string or a {sqlpp} statement, use the `\ECHO` command, followed by the string or statement.

====
.Example
[source,sqlpp]
----
\ECHO hello;
----

.Result
----
hello
----
====

=== Echo an Alias

To echo a command alias, use the `\ECHO` command, followed by two backslashes and the command alias name.

====
.Example
[source,sqlpp]
----
\ECHO \\travel-alias1;
----

.Result
[source,sqlpp]
----
SELECT * FROM `travel-sample`.inventory.airline LIMIT 1;
----
====

=== Echo a Parameter

To echo a parameter, use the `\ECHO` command, followed by the parameter prefix and parameter name.

If you do not include the parameter prefix, the shell considers the parameter as a generic statement and displays the parameter as is.

====
.Example
[source,sqlpp]
----
\ECHO -$r;
----

.Result
----
9.5
----
====

[#cbq-shell-cmd-alias]
== Command Alias

Using the ALIAS shell command, you can define and store aliases for commands.
This is useful when you have lengthy queries that need to be executed often.

=== Create Command Aliases

To define an alias, use the `\ALIAS` command, followed by the command alias name and the query.

====
.Example
[source,sqlpp]
----
\ALIAS travel-alias1 SELECT * FROM `travel-sample`.inventory.airline LIMIT 1;
----
====

=== Run Command Aliases

To run the command alias, type two backslashes `\\`, followed by the command alias name.

====
.Example
[source,sqlpp]
----
\\travel-alias1;
----

.Result
[source,json]
----
{
    "requestID": "b25c84d6-7b7b-440a-a286-5027e6ecbbb5",
    "signature": {
        "*": "*"
    },
    "results": [
    {
        "airline": {
            "callsign": "MILE-AIR",
            "country": "United States",
            "iata": "Q5",
            "icao": "MLA",
            "id": 10,
            "name": "40-Mile Air",
            "type": "airline"
        }
    }
    ],
    "status": "success",
    // ...
}
----
====

=== List Command Aliases

To list all the existing aliases, use the `\ALIAS` command without options.

====
.Example
[source,sqlpp]
----
\ALIAS;
----

.Result
----
serverversion  select version()
travel-alias1  SELECT * FROM `travel-sample`.inventory.airline LIMIT 1;
----
====

=== Delete Command Aliases

You can delete a defined alias using the `\UNLIAS` command, followed by the alias name.
This command can take multiple arguments and deletes the defined alias for every input name.

====
.Example
[source,sqlpp]
----
\UNALIAS serverversion travel-alias1;
----

.Check aliases
[source,sqlpp]
----
\ALIAS;
----

.Result
----
 ERROR 141 : Alias does not exist :
----
====

[#cbq-prepared-stmts]
== Executing Prepared Statements

You can use the shell command to execute prepared statements.
As a pre-requisite, you must first prepare a statement.
To prepare and execute a statement, follow these steps:

. Set the named and positional parameters that are present in the prepared statement.
. Prepare a statement using the {sqlpp} xref:n1ql:n1ql-language-reference/prepare.adoc[PREPARE] statement.
If you do not specify a name for the prepared statement, a unique name is assigned.
You can use this auto-assigned name when executing the prepared statement.
If you specify a name, you can use this name to run the prepared statement.
. Execute the prepared statement using the {sqlpp} xref:n1ql:n1ql-language-reference/execute.adoc[EXECUTE] statement.

== Canceling a Query

You can cancel a running query by using the kbd:[Ctrl+C] keys.

=== Connection Timeout Parameter

You can use the timeout parameter to limit the running time of a query.
This parameter specifies the time to wait before returning an error when executing a query.

Timeout can be specified in the following units: `ns` for nanoseconds, `μs` for microseconds, `ms` for milliseconds, `s` for seconds, `m` for minutes, and `h` for hours.
Examples of valid values include `"0.5s"`, `"10ms"`, or `"1m"`.
An error is thrown if the timeout is invalid.

[tabs]
====
Command Line Option::
+
--
Use the `-t` or `--timeout` command line option, followed by the length of the timeout.

'''

.Example
[source,sh]
----
./cbq -e $BASE_URL -u $USER -p $PASSWORD -skip-verify --timeout="2s"
----
--

Shell Command::
+
--
Use the `\SET` shell command to set the `TIMEOUT` parameter, followed by the length of the timeout.

'''

.Example
[source,sqlpp]
----
\SET -TIMEOUT 1ms;
----
--
====

[#cbq-file-based-ops]
== File Based Operations

Using the file based commands and options, the cbq shell can execute {sqlpp} and shell commands contained in files.
There are two ways to accomplish this.

[tabs]
====
Command Line Option::
+
--
Use the `-f` or `--file` command line option, followed by the input file.

The cbq shell executes the commands present in the input file, prints them to stdout (or to a file if using redirects), and exits.

'''
// tag::sample-txt[]
Consider the input file, `sample.txt`, containing the following commands.

[source,sqlpp]
.sample.txt
----
CREATE PRIMARY INDEX ON `travel-sample`.inventory.airline USING GSI;
SELECT * from `travel-sample`.inventory.airline LIMIT 2;
SELECT callsign from `travel-sample`.inventory.airline LIMIT 3;
\HELP;
----
// end::sample-txt[]

[source,sh]
.Example
----
./cbq -e $BASE_URL -u $USER -p $PASSWORD -skip-verify -f=sample.txt
----

.Results
[source,console]
----
 Connected to : https://<HOST>:18091/. Type Ctrl-D or \QUIT to exit.

 Path to history file for the shell : ~/.cbq_history 
CREATE PRIMARY INDEX ON `travel-sample`.inventory.airline USING GSI;
{ ...
  "results": [ ],
  ...
}
SELECT * from `travel-sample`.inventory.airline LIMIT 2;
{ ...
  "results": [ ],
  ...
}
SELECT callsign from `travel-sample`.inventory.airline LIMIT 3;
{ ...
  "results": [ ],
  ...
}
\HELP;
Help information for all shell commands.
...
$
----
--

Shell Command::
+
--
Use the `\SOURCE` shell command, followed by the input file.

The cbq shell executes the commands present in the input file and prints them to stdout, or to a file if using redirects.

'''

include::cbq.adoc[tag=sample-txt]

[source,sqlpp]
.Example
----
\SOURCE sample.txt;
----

.Results
[source,console]
----
CREATE PRIMARY INDEX ON `travel-sample`.inventory.airline USING GSI;
{ ...
  "results": [ ],
 ...
}
SELECT * from `travel-sample`.inventory.airline LIMIT 2;
{ ...
  "results": [ ],
  ...
}
SELECT callsign from `travel-sample`.inventory.airline LIMIT 3;
{ ...
  "results": [ ],
  ...
}
\HELP;
Help information for all shell commands.
...
cbq>
----
--
====

=== Redirecting Results to a File

You can redirect all the output for a session or part of a session to a specified output file.
If the file doesn't exist, it is created.
If the file already exists, it is overwritten.

[tabs]
====
Command Line Option::
+
--
Use the `-o` or `--output` command line option, followed by the output file.

'''

.Example
[source,sh]
----
./cbq -e $BASE_URL -u $USER -p $PASSWORD -skip-verify -o temp_output.txt
----
--

Shell Command::
+
--
To start redirecting commands during a session, use `\REDIRECT` followed by the output file.
To stop redirecting commands, use `\REDIRECT OFF`.
All the commands specified after `\REDIRECT` and before `\REDIRECT OFF` are saved into the specified output file.

You can specify multiple `\REDIRECT` commands.
When you do so, the output file changes to the specified files and switches back to [.out]`stdout` only when you specify `\REDIRECT OFF`.

You can append redirected output to an existing file using <<file-append-mode>>.

'''

.Example
[source,sqlpp]
----
\REDIRECT temp_output.txt;
CREATE PRIMARY INDEX ON `travel-sample`.inventory.airline USING GSI;
SELECT * FROM `travel-sample`.inventory.airline LIMIT 1;
\HELP;
\REDIRECT OFF;
----
--
====

[[file-append-mode]]
=== File Append Mode

You can use file append mode to specify that cbq should append redirected output to the end of an existing file, rather than overwriting the existing file.

Note that file append mode is only available with the `\REDIRECT` command within a shell session.
It is not available for the `-o` or `--output` command line option.
When you use the `-o` or `--output` command line option, the specified output file is always overwritten.

To use file append mode, include a plus sign `+` at the start of the output path or filename.

====
.Example
[source,sqlpp]
----
\REDIRECT +temp_output.txt;
SELECT * FROM `travel-sample`.inventory.airline LIMIT 1;
\REDIRECT OFF;
----

Every time you start appending to the output file, a timestamp is added to the end of the output file, followed by any redirected commands and results.

----
-- <2021-07-30T14:48:43.661+01:00> : opened in append mode

SELECT * FROM `travel-sample`.inventory.airline LIMIT 1
...
----
====

[#cbq-server-shell-info]
== Database and Shell Information

The cbq shell provides commands that convey information about the shell or Couchbase Capella database.

=== Version

You can find the version of the client (shell) by using either the command line option to display the current version of the shell and exit, or as a shell command to print the version of the shell during the shell session.

To display the version of the query service, use the xref:n1ql:n1ql-language-reference/metafun.adoc#version[VERSION()] function in {sqlpp}.

[tabs]
====
Command Line Option::
+
--
Use the `-v` or `--version` command line option.

'''

.Example
[source,sh]
----
./cbq -v
----

.Result
----
GO VERSION : go1.21.6
SHELL VERSION : 7.6.0-2176

Use N1QL queries select version(); or select min_version(); to display server version.
----
--

Shell Command::
+
--
Use the `\VERSION` shell command.

'''

.Example
[source,sqlpp]
----
\VERSION;
----

.Result
----
GO VERSION : go1.21.6
SHELL VERSION : 7.6.0-2176

Use N1QL queries select version(); or select min_version(); to display server version.
----
--
====

=== Copyright

You can view the copyright, attributions, and distribution terms of the command line query tool using the `\COPYRIGHT` shell command.

====
.Example
[source,sqlpp]
----
\COPYRIGHT;
----

.Result
----
Copyright (c) 2016 Couchbase, Inc. Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software distributed under the
License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
either express or implied. See the License for the specific language governing permissions
and limitations under the License.
----
====

== Exiting the cbq Shell

You can exit the cbq shell by pressing kbd:[Ctrl+D] or by using the `\EXIT` or `\QUIT` command.

The cbq shell first saves the history, closes existing connections, saves the current session in a session file, resets all environment variables, and then closes the shell liner interface.

====
.Example
[source,sqlpp]
----
\EXIT;
----

.Result
[source,console]
----
$
----
====

== Executing a Script

You can use the [.param]`--script` option to start cbq, execute a single {sqlpp} query, and exit the shell.

====
.Example
[source,sh]
----
./cbq -u $USER -p $PASSWORD -e $BASE_URL -skip-verify \
--script="SELECT * FROM \`travel-sample\`.inventory.airline LIMIT 1;"
----

.Results
----
Connected to : https://<HOST>:18091/. Type Ctrl-D or \QUIT to exit.

Path to history file for the shell : ~/.cbq_history

SELECT * FROM `travel-sample`.inventory.airline LIMIT 1;
{
    ...
}
----
====

=== Exit On Error

When you specify the argument `--exit-on-error`, the cbq shell checks the result returned after executing the query for any error and exits when the first error is encountered.

=== Exit Status

The cbq shell returns the exit status 0 for successful exit with no errors and 1 if an error was encountered before exiting.

== Available Command Line Options and Shell Commands

NOTE: The <<table_a3h_rhz_dw,command line options>> are case sensitive.
The <<table_htk_hgc_fw,cbq shell commands>> are case insensitive.

.Command Line Options for cbq Shell
[#table_a3h_rhz_dw,cols="~,~,55"]
|===
| Option | Arguments | Description and Examples

| [[opt-engine]]
`-e`

`--engine`
| string (url)
a| The connection string consists of a protocol scheme, followed by a host.

For more details, refer to <<cbq-connect-to-cluster>>.

Shell command: <<cbq-connect,\CONNECT>>

.Default
`+http://localhost:8091+`

.Examples
[source,sh]
----
./cbq --engine $BASE_URL \
-u $USER -p $PASSWORD -skip-verify
----

[source,sh]
----
./cbq -e $BASE_URL \
-u $USER -p $PASSWORD -skip-verify
----

.Result
----
Connected to : https://<HOST>:18091/. Type Ctrl-D or \QUIT to exit.
Path to history file for the shell : /Users/myuser1/.cbq_history
----

| [[opt-no-engine]]
`-ne`

`--no-engine`
| boolean footnote:boolean[Invoking a boolean option with no value sets the value to `true`.]
a| When specified, the cbq shell does not connect to any query service.
You must explicitly connect to a query service using the <<cbq-connect,\CONNECT>> shell command.

.Default
`false`

.Example
[source,sh]
----
./cbq --no-engine
----

| [[opt-ncfg]]
`-ncfg`

`--networkconfig`
| string (`auto`, `default`, `external`)
a| Specifies whether to connect to a node's principal or alternate address.

* `auto` -- Select the principal address or alternate address automatically, depending on the input IP.
* `default` -- Use the principal address.
* `external` -- Use the alternate addresses.

.Default
`auto`

.Example
[source,sh]
----
./cbq -ncfg default \
-e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

| [[opt-quiet]]
`-q`

`--quiet`
| boolean footnote:boolean[]
a| When specified, disables the startup connection message for the cbq shell.

.Default
`false`

.Example
[source,sh]
----
./cbq -q \
-e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

.Result
[source,console]
----
cbq>
----

| [[opt-advise]]
`-ad`

`--advise`
| boolean footnote:boolean[]
a| Runs ADVISE on all queries in the specified file, or that are read from standard input, if a file is not provided with the `-file` option.

.Default
`false`

.Example
[source, sh]
----
./cbq -advise -file queries.txt \
-e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

.queries.txt
[source, sqlpp]
----
SELECT ADVISOR(["select * from collection1 where id = 1;",
                "select * from collection2 where name is not missing;"])
----

.Result
[source, json]
----
{
    "requestID": "15ed5c93-e5f6-4193-83fa-6fdc87847552",
    "signature": {
        "$1": "object"
    },
    "results": [
    {
        "$1": {
            "recommended_indexes": [
                {
                    "index": "CREATE INDEX adv_id ON `collection1`(`id`)",
                    "statements": [
                        {
                            "run_count": 1,
                            "statement": "select * from collection1 where id = 1;"
                        }
                    ]
                },
                {
                    "index": "CREATE INDEX adv_name ON `collection2`(`name`)",
                    "statements": [
                        {
                            "run_count": 1,
                            "statement": "select * from collection2 where name is not missing;"
                        }
                    ]
                }
            ]
        }
    }
    ]
}
----

| [[opt-analytics]]
`-a`

`--analytics`
| boolean footnote:boolean[]
a| Only applicable when connecting to the Analytics Service.
If specified, when you connect to a Couchbase Capella database, cbq automatically discovers and connects to the Analytics service.
This option also switches on <<opt-batch,batch mode>>.

.Default
`false`

.Example
[source,sh]
----
./cbq --analytics \
-e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

| [[opt-batch]]
`-b`

`--batch`
| string (`on`, `off`)  footnote:[Invoking this option with no value sets the value to `on`.]
a| This option is available only with the Analytics Service.
When specified, cbq sends the queries to Analytics only when you hit EOF or \ to indicate the end of the batch input.

.Default
`off`

.Examples
[source,sh]
----
./cbq --batch \
-e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

You can also set the batch mode in the interactive session using the <<cbq-set,\SET>> command:

[source,sqlpp]
----
\set batch on;
\set batch off;
----

| [[opt-qc]]
`-qc`

`--query_context`
| string
a| Sets the query context parameter.
For more information, see xref:n1ql:n1ql-intro/queriesandresults.adoc#query-context[Query Context].

Shell command: <<cbq-set,\SET>> `-query_context`

.Default
none

.Example
[source,sh]
----
./cbq -qc "travel-sample.inventory" \
-e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

| [[opt-timeout]]
`-t`

`--timeout`
| string (duration)
a| Sets the query timeout parameter.
For more information, see xref:n1ql:n1ql-manage/query-settings.adoc#timeout_req[timeout].

Shell command: <<cbq-set,\SET>> `-timeout`

.Default
`0ms`

.Example
[source,sh]
----
./cbq --timeout="1s" \
-e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

For further examples, see <<connection-timeout-parameter>>.

| [[opt-user]]
`-u`

`--user`
| string
a| Specifies a single user name to log in to Couchbase.
When used by itself, without the `-p` option to specify the password, you will be prompted for the password.

This option requires administration credentials and you cannot switch the credentials during a session.

Couchbase recommends using the `-u` and `-p` option if your password contains special characters such as #, $, %, &, (,), or '.

.Default
none

.Example
[source,sh]
----
./cbq -u $USER \
-e $BASE_URL -skip-verify
----

.Result
----
Enter Password:
----

| [[opt-password]]
`-p`

`--password`
| string
a| Specifies the password for the given user name.
You cannot use this option by itself.
It must be used with the -u option to specify the user name.

This option requires administration credentials and you cannot switch the credentials during a session.

Couchbase recommends using the `-u` and `-p` option if your password contains special characters such as #, $, %, &, (,), or '.

.Default
none

.Example
[source,sh]
----
./cbq -u $USER -p $PASSWORD \
-e $BASE_URL -skip-verify
----

| [[opt-credentials]]
`-c`

`--credentials`
| string
a| Specify the login credentials in the form of [.var]`username`:[.var]``password``.
If you specify more than one credential with this option, Couchbase Capella only uses the first one.

Shell command: <<cbq-set,\SET>> `-creds`

ifdef::flag-devex-rest-api[]
REST API: `-creds` parameter
endif::flag-devex-rest-api[]

.Default
none

.Example
[source,sh]
----
./cbq -c=$USER:$PASSWORD \
-e $BASE_URL -skip-verify
----

| [[opt-version]]
`-v`

`--version`
| boolean footnote:boolean[]
a| When specified, provides the version of the cbq shell.
To display the version of the query engine (this is not the same as the version of the Couchbase Capella database), use one of the following {sqlpp} queries:

[source,sqlpp]
----
select version();
----

[source,sqlpp]
----
select min_version();
----

Shell command: <<cbq-version,\VERSION>>

.Default
`false`

.Example
[source,sh]
----
./cbq --version
----

.Result
----
GO VERSION : go1.21.6
SHELL VERSION : 7.6.0-2176

Use N1QL queries select version(); or select min_version(); to display server version.
----

| [[opt-help]]
`-h`

`--help`
| none
a| Provides help for the command line options.

Shell command: <<cbq-help,\HELP>>

.Default
none

.Example
[source,sh]
----
./cbq --help
----

| [[opt-script]]
`-s`

`-script`
| string
a| Provides a single command mode to execute a query from the command line.

You can also use multiple `-s` options on the command line.
If one of the commands is incorrect, an error is displayed for that command and cbq continues to execute the remaining commands.

.Default
none

.Examples
[source,sh]
----
./cbq -s="SELECT * FROM \`travel-sample\`.inventory.airline LIMIT 1;" \
-e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

[source,sh]
----
./cbq -s="\SET v 1" -s="\SET b 2" -s="\PUSH b3" \
-s="\SET b 5" -s="\SET" -ne
----

.Result
----
Path to history file for the shell : ~/.cbq_history 

 \SET v 1
 \SET b 2
 \PUSH b3
 ERROR 139 : Too few input arguments to command. 
 \SET b 5
 \SET

 Query Parameters : 
 Named Parameters : 
 User Defined Session Parameters : 
 Predefined Session Parameters : 
 Parameter name : histfile
 Value : [".cbq_history"]
 Parameter name : batch
 Value : ["off"]
 Parameter name : quiet
 Value : [false]
 Parameter name : v
 Value : [1]
 Parameter name : b
 Value : [5]
----

| [[opt-file]]
`-f`

`--file`
| string (path)
a| Provides an input file which contains all the commands to be run.

Shell command: <<cbq-source,\SOURCE>>

.Default
none

.Example
[source,sh]
----
./cbq --file="sample.txt" \
-e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

| [[opt-output]]
`-o`

`--output`
| string (path)
a| Specifies an output file where the commands and their results are to be written.

If the file doesn't exist, it is created.
If the file already exists, it is overwritten.

Shell command: <<cbq-redirect,\REDIRECT>>

.Default
none

.Example
[source,sh]
----
./cbq -o="results.txt" -s="SELECT * FROM \`travel-sample\`.inventory.airline LIMIT 1;" \
-e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

| [[opt-pretty]]
`--pretty`
| boolean footnote:boolean[]
a| Specifies whether the output should be formatted with line breaks and indents.

This option is set to `true` by default.
To specify that the output should _not_ be formatted with line breaks and indents, you must explicitly set this option to `false`.

.Default
`true`

.Example
[source,sh]
----
./cbq --pretty=false -s="SELECT * FROM \`travel-sample\`.inventory.airline LIMIT 1;" \
-e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

| [[opt-exit-on-error]]
`--exit-on-error`
| boolean footnote:boolean[]
a| When specified, the cbq shell must exit when it encounters the first error.

.Default
`false`

.Example
[source,sh]
----
./cbq --exit-on-error -f="sample.txt" \
-e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

| [[opt-cacert]]
`--cacert`
| string (path)
a| Only applicable when using an encrypted protocol scheme, such as `couchbases://`.

Specifies the path to the root CA certificate to verify the identity of the database.

.Default
none

.Example
[source,sh]
----
./cbq --cacert $CACERT \
-e $BASE_URL -u $USER -p $PASSWORD -skip-verify
----

| [[opt-cert]]
`--cert`
| string (path)
a| Only applicable when using an encrypted protocol scheme, such as `couchbases://`.

Specifies the path to the chain certificate.

.Default
none

.Example
[source,sh]
----
./cbq --cert ./client/client/chain.pem
----

| [[opt-key]]
`--key`
| string (path)
a| Only applicable when using an encrypted protocol scheme, such as `couchbases://`.

Specifies the path to the client key file.

.Default
none

.Examples
[source,sh]
----
./cbq --key ./client/client/client.key
----

| [[opt-skip-verify]]
`--no-ssl-verify` or

`-skip-verify`
| boolean footnote:boolean[]
a| Only applicable when using an encrypted protocol scheme, such as `couchbases://`.

When specified, the cbq shell can skip the verification of certificates.

.Default
`false`

.Examples
[source,sh]
----
./cbq --no-ssl-verify -f="sample.txt" \
-e $BASE_URL -u $USER -p $PASSWORD
----

[source,sh]
----
./cbq -skip-verify \
-e $BASE_URL -u $USER -p $PASSWORD
----
|===

.cbq Shell Commands
[#table_htk_hgc_fw,cols="~,~,55"]
|===
| Shell Command | Arguments | Description and Examples

| [[cbq-connect]]
[.cmd]`\CONNECT`
| [.var]`url`
a| Connects cbq shell to the specified Couchbase Capella database.

The connection string consists of a protocol scheme, followed by a host.

For more details, refer to <<cbq-connect-to-cluster>>.

Command Line Option: <<opt-engine,-e>> or <<opt-engine,--engine>>

.Examples
[source,sqlpp]
----
\CONNECT <BASE_URL>;
----

| [[cbq-disconnect]]
[.cmd]`\DISCONNECT`
| none
a| Disconnects the cbq shell from the Couchbase Capella database.

.Example
[source,sqlpp]
----
\DISCONNECT;
----

.Result
----
 Couchbase query shell not connected to any endpoint.
 Use \CONNECT command to connect.
----

| [[cbq-quit]]
[.cmd]`\EXIT`

[.cmd]`\QUIT`
| none
a| Exits cbq shell.

.Examples
[source,sqlpp]
----
\EXIT;
----

[source,sqlpp]
----
\QUIT;
----

| [[cbq-set]]
[.cmd]`\SET`
| [.var]`parameter` [.var]`value`

[.var]`parameter` = [.var]`prefix` : [.var]`variable name`
a| Sets the top most value of the stack for the given variable with the specified value.

Variables can be of the following types:

* Query parameters
* Session variables
* User-defined
* Pre-defined and named parameters.

When the [.cmd]`\SET` command is used without any arguments, it displays the values for all the parameters of the current session.

.Examples
[source,sqlpp]
----
\SET -args [5, "12-14-1987"];
----

[source,sqlpp]
----
\SET -args [6,7];
----

| [[cbq-push]]
[.cmd]`\PUSH`
| [.var]`parameter` [.var]`value`
a| Pushes the specified value on to the given parameter stack.

When the [.cmd]`\PUSH` command is used without any arguments, it copies the top element of every variable's stack, and then pushes that copy to the top of the respective variable's stack.

While each variable stack grows by 1, the previous values are preserved.

.Examples
[source,sqlpp]
----
\PUSH -args  [8];
\PUSH;
----

.Check variable stack
[source,sqlpp]
----
\SET;
----

.Result
----
 Query Parameters :
 Parameter name : args
 Value : [[6,7] [8] [8]]
...
----

| [[cbq-unset]]
[.cmd]`\UNSET`
| [.var]`parameter`
a| Deletes or resets the entire stack for the specified parameter.

.Examples
[source,sqlpp]
----
\UNSET -args;
\SET;
----

.Result
----
 Query Parameters :
 ...
----

| [[cbq-pop]]
[.cmd]`\POP`
| [.var]`parameter`
a| Pops the top most value from the specified parameter's stack.

When the [.cmd]`\POP` command is used without any arguments, it pops the top most value of every variable's stack.

.Examples
[source,sqlpp]
----
\POP -args;
\SET;
----

.Result
----
 Query Parameters :
 Parameter name : args
 Value : [[6,7] [8]]
----

| [[cbq-alias]]
[.cmd]`\ALIAS`
| [.var]`shell-command` or [.var]`n1ql-statement`
a| Creates a command alias for the specified cbq shell command or {sqlpp} statement.
You can then execute the alias using `\\alias-name;`.

When the [.cmd]`\ALIAS` command is used without any arguments, it lists all the available aliases.

.Examples
[source,sqlpp]
----
\ALIAS travel-limit1 SELECT * FROM `travel-sample`.inventory.airline LIMIT 1;
\ALIAS;
----

.Result
----
serverversion  select version()
travel-limit1  SELECT * FROM `travel-sample`.inventory.airline LIMIT 1
----

.Execute alias
[source,sqlpp]
----
\\serverversion;
----

.Result
[source,json]
----
{
    "requestID": "ef63f01b-f159-437f-a4df-28d6145fa3c2",
    "signature": {
        "$1": "string"
    },
    "results": [
        {
            "$1": "7.0.0-N1QL"
        }
    ],
    "status": "success",
    "metrics": {
        "elapsedTime": "14.54962ms",
        "executionTime": "13.164635ms",
        "resultCount": 1,
        "resultSize": 34,
        "serviceLoad": 12
    }
}
----

| [[cbq-unalias]]
[.cmd]`\UNALIAS`
| [.var]`alias-name`
a| Deletes the specified alias.

.Examples
[source,sqlpp]
----
\UNALIAS travel-limit1;
\ALIAS;
----

.Result
----
serverversion  select version()
----

| [[cbq-echo]]
[.cmd]`\ECHO`
| [.var]`args`

where [.var]`args` can be parameters, aliases, or any input.
a| If the input is a parameter, this command echoes (displays) the value of the parameter.
The parameter must be prefixed according to its type.
See <<table_ltk_c5s_5v>> for details.

If the input is not a parameter, the command echoes the statement as is.

If the input is an alias, the command displays the value of an alias command.

.Examples
[source,sqlpp]
----
\ECHO -$r;
\ECHO \\serverversion;
----

.Result
----
select version()
----

| [[cbq-version]]
[.cmd]`\VERSION`
| none
a| Displays the version of the client shell.

Command Line Option: <<opt-version,-v>> or <<opt-version,--version>>

.Example
[source,sqlpp]
----
\VERSION;
----

.Result
----
GO VERSION : go1.21.6
SHELL VERSION : 7.6.0-2176

Use N1QL queries select version(); or select min_version(); to display server version.
----

| [[cbq-help]]
[.cmd]`\HELP`
| [.var]`command`
a| Displays the help information for the specified command.
When used without any arguments, it lists all the commands supported by the cbq shell.

Command Line Option: <<opt-help,-h>> or <<opt-help,--help>>

.Example
[source,sqlpp]
----
\HELP ECHO;
----

.Result
----
\ECHO args ...
Echo the input value. args can be a name (a prefixed-parameter), an alias (command alias) or
a value (any input statement).
Example :
\ECHO -$r ;
\ECHO \\tempalias;
----

| [[cbq-copyright]]
[.cmd]`\COPYRIGHT`
| none
a| Displays the copyright, attributions, and distribution terms.

.Example
[source,sqlpp]
----
\COPYRIGHT;
----

| [[cbq-source]]
[.cmd]`\SOURCE`
| [.var]`input-file`
a| Reads and executes the commands from a file.
Multiple commands in the input file must be separated by `;` and a new line.

Command Line Option: <<opt-file,-f>> or <<opt-file,--file>>

For example, `sample.txt` contains the following commands:

[source,sqlpp]
.sample.txt
----
SELECT * FROM `travel-sample`.inventory.airline LIMIT 1;
\ECHO this;
#This is a comment;
----

.Example
[source,sqlpp]
----
\SOURCE sample.txt;
----

| [[cbq-redirect]]
[.cmd]`\REDIRECT`
| [.var]`filename`
a| Redirects the output of all the commands to the specified file until the cbq shell receives the [.cmd]`\REDIRECT OFF` command.
By default, the file is created in the directory that you were in when you started the cbq shell.
You can specify a different location using relative paths.

If the file doesn't exist, it is created.
If the file already exists, it is overwritten.
You can append redirected output to an existing file using <<file-append-mode>>.

Command Line Option:  <<opt-output,-o>> or <<opt-output,--output>>

.Example
[source,sqlpp]
----
\REDIRECT temp_out.txt;
----

| [[cbq-redirect-off]]
[.cmd]`\REDIRECT OFF`
| none
a| Redirects the output of subsequent commands from a custom file to standard output (os.stdout).

.Example
[source,sqlpp]
----
\REDIRECT OFF;
----
|===

== Shortcut Keys for cbq Shell

The following table lists the shortcut keys used by the [.cmd]`cbq` shell.

.Shortcut Keys for cbq Shell
[cols="100,197"]
|===
| Keystroke | Action

| kbd:[Ctrl+A], kbd:[Home]
| Move cursor to beginning of line

| kbd:[Ctrl+E], kbd:[End]
| Move cursor to end of line

| kbd:[Ctrl+B], kbd:[Left]
| Move cursor one character left

| kbd:[Ctrl+F], kbd:[Right]
| Move cursor one character right

| kbd:[Ctrl+Left]
| Move cursor to previous word

| kbd:[Ctrl+Right]
| Move cursor to next word

| kbd:[Ctrl+D], kbd:[Del]
| (if line is not empty) Delete character under cursor

| kbd:[Ctrl+D]
| (if line is empty) End of File - usually quits application

| kbd:[Ctrl+C]
| Reset input (create new empty prompt)

| kbd:[Ctrl+L]
| Clear screen (line is unmodified)

| kbd:[Ctrl+T]
| Transpose previous character with current character

| kbd:[Ctrl+H], kbd:[BackSpace]
| Delete character before cursor

| kbd:[Ctrl+W]
| Delete word leading up to cursor

| kbd:[Ctrl+K]
| Delete from cursor to end of line

| kbd:[Ctrl+U]
| Delete from start of line to cursor

| kbd:[Ctrl+P], kbd:[Up]
| Previous match from history

| kbd:[Ctrl+N], kbd:[Down]
| Next match from history

| kbd:[Ctrl+R]
| Reverse Search history (kbd:[Ctrl+S] forward, kbd:[Ctrl+G] cancel)

| kbd:[Ctrl+Y]
| Paste from Yank buffer (kbd:[Alt+Y] to paste next yank instead)

| kbd:[Tab]
| Next completion

| kbd:[Shift+Tab]
| (after kbd:[Tab]) Previous completion
|===

Source: https://github.com/peterh/liner[]
